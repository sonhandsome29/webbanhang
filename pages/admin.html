<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>

    <!-- CSS chung c·ªßa project -->
    <link rel="stylesheet" href="../css/base.css" />
    <link rel="stylesheet" href="../css/layout.css" />
    <link rel="stylesheet" href="../css/components.css" />
    <link rel="stylesheet" href="../css/style.css" />

    
    <link rel="stylesheet" href="../css/pages/admin.css" />
  </head>

  <body class="admin-page">
    <main class="o-container admin-wrap">
      <!-- Topbar -->
      <section class="admin-topbar">
        <div>
          <div class="admin-breadcrumb">Dashboard / <strong>Products</strong></div>
          <h1 class="admin-title">üëë ADMIN ‚Äì Qu·∫£n l√Ω s·∫£n ph·∫©m</h1>
          <p class="admin-subtitle">
    
          </p>
        </div>

        <div class="admin-actions">
          <!-- ‚úÖ v√¨ admin.html n·∫±m trong /pages n√™n v·ªÅ home ph·∫£i ../ -->
          <a class="admin-btn admin-btn--ghost" href="../index.html">üè† V·ªÅ trang ch·ªß</a>

          <!-- ‚úÖ g·ªçi logout() trong admin.js -->
          <button class="admin-btn admin-btn--danger" type="button" onclick="logout()">
            üö™ Logout
          </button>
        </div>
      </section>

      <!-- Stats -->
      <section class="admin-stats">
        <div class="admin-stat">
          <div class="admin-stat__label">T·ªïng s·∫£n ph·∫©m</div>
          <div class="admin-stat__value" id="statTotalProducts">0</div>
        </div>

        <div class="admin-stat">
          <div class="admin-stat__label">Danh m·ª•c</div>
          <div class="admin-stat__value" id="statCategories">0</div>
        </div>

        <div class="admin-stat">
          <div class="admin-stat__label">C·∫≠p nh·∫≠t g·∫ßn nh·∫•t</div>
          <div class="admin-stat__value" id="statLastUpdate">‚Äî</div>
        </div>
      </section>

      <div class="admin-grid">
        <!-- Form card -->
        <section class="admin-card">
          <div class="admin-card__head">
            <h2 class="admin-card__title">‚ûï Th√™m / S·ª≠a s·∫£n ph·∫©m</h2>
            <p class="admin-card__desc">Click 1 d√≤ng trong b·∫£ng ƒë·ªÉ edit nhanh.</p>
          </div>

          <div class="admin-form">
            <div class="admin-field">
              <label class="admin-label" for="id">ID s·∫£n ph·∫©m</label>
              <input id="id" class="admin-input" placeholder="V√≠ d·ª•: 101" />
            </div>

            <div class="admin-field">
              <label class="admin-label" for="name">T√™n s·∫£n ph·∫©m</label>
              <input id="name" class="admin-input" placeholder="V√≠ d·ª•: √Åo s∆° mi nam" />
            </div>

            <div class="admin-field">
              <label class="admin-label" for="price">Gi√°</label>
              <input id="price" class="admin-input" placeholder="V√≠ d·ª•: 199000" />
            </div>

            <div class="admin-field">
              <label class="admin-label" for="category">Category</label>
              <select id="category" class="admin-input">
                <option value="">-- Ch·ªçn category --</option>
                <option value="Fashion Women">Fashion Women</option>
                <option value="Fashion Men">Fashion Men</option>
                <option value="Electronics">Electronics</option>
                <option value="Home">Home</option>
                <option value="Beauty">Beauty</option>
              </select>
            </div>

            <div class="admin-field admin-field--full">
              <label class="admin-label" for="imgFile">·∫¢nh s·∫£n ph·∫©m</label>
              <div class="admin-upload">
                <input type="file" id="imgFile" accept="image/*" />
                <img id="preview" class="admin-preview" alt="Preview" style="display: none" />
              </div>
              <small class="admin-hint">Ch·ªçn ·∫£nh ƒë·ªÉ xem preview.</small>
            </div>

            <div class="admin-field admin-field--full">
              <label class="admin-label" for="desc">M√¥ t·∫£</label>
              <textarea
                id="desc"
                class="admin-textarea"
                placeholder="M√¥ t·∫£ s·∫£n ph·∫©m..."
              ></textarea>
            </div>

            <div class="admin-field admin-field--full admin-form__actions">
              <!-- ‚úÖ g·ªçi addOrUpdate() trong admin.js -->
              <button id="btnSaveProduct" class="admin-btn admin-btn--primary" type="button">
                üíæ L∆∞u s·∫£n ph·∫©m
              </button>
            </div>
          </div>
        </section>

        <!-- Table card -->
        <section class="admin-card">
          <div class="admin-card__head">
            <h2 class="admin-card__title">üì¶ Danh s√°ch s·∫£n ph·∫©m</h2>
            <p class="admin-card__desc">Click 1 d√≤ng ƒë·ªÉ s·ª≠a. N√∫t ‚ùå ƒë·ªÉ xo√°.</p>
          </div>

          <div class="admin-table-wrap">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>T√™n</th>
                  <th>Gi√°</th>
                  <th>·∫¢nh</th>
                  <th>Category</th>
                  <th>M√¥ t·∫£</th>
                  <th>Xo√°</th>
                </tr>
              </thead>

              <!-- ‚úÖ admin.js render v√†o ƒë√¢y -->
              <tbody id="productTable"></tbody>
            </table>
          </div>
        </section>
      </div>
    </main>

    <!-- ‚úÖ admin.js n·∫±m ·ªü /js/pages -->
    <script src="../js/pages/admin.js"></script>

    <!-- ‚úÖ Stats helper: update stats sau khi renderTable -->
    <script>
      function updateAdminStats() {
        const products = JSON.parse(localStorage.getItem("products")) || [];

        const totalEl = document.getElementById("statTotalProducts");
        const catEl = document.getElementById("statCategories");
        const lastEl = document.getElementById("statLastUpdate");

        if (totalEl) totalEl.textContent = products.length;

        const cats = new Set(products.map((p) => p.category).filter(Boolean));
        if (catEl) catEl.textContent = cats.size;

        const now = new Date();
        if (lastEl)
          lastEl.textContent =
            now.toLocaleDateString("vi-VN") + " " + now.toLocaleTimeString("vi-VN");
      }

      // ch·∫°y 1 l·∫ßn khi load
      updateAdminStats();

      // hook renderTable() ƒë·ªÉ sau khi CRUD xong stats c·∫≠p nh·∫≠t lu√¥n
      const _oldRender = window.renderTable;
      if (typeof _oldRender === "function") {
        window.renderTable = function () {
          _oldRender();
          updateAdminStats();
        };
      }
    </script>
  </body>
</html>
